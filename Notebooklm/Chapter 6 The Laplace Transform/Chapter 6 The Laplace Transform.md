# 6.1 Definition of the Laplace Transform

#### 1. 核心概念 (Core Concept)

本节的核心内容分为两部分：

1. **为拉普拉斯变换做铺垫：反常积分 (Improper Integrals) 的回顾**。
2. **定义拉普拉斯变换 (Definition of the Laplace Transform)** 及其存在性条件。

**直觉：为什么要使用拉普拉斯变换？**

在许多实际工程问题中，机械或电气系统往往受到**不连续 (discontinuous)** 或**脉冲 (impulsive) 强迫项**的作用。对于这类问题，我们在第 3 章学到的传统微分方程解法往往显得非常笨拙。拉普拉斯变换则特别适用于处理这类问题，尽管它的用途远不止于此。

拉普拉斯变换的核心思想是：它将**时域 ($t$-domain)** 中的未知函数 $f(t)$ 的**初始值问题**，转化为**$s$-域 ($s$-domain)** 中更容易处理的**代数问题**，然后通过求解代数问题找到 $F(s)$，最后再将其**反演**回我们需要的 $f(t)$。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 反常积分 (Improper Integrals)

**定义：** 由于拉普拉斯变换涉及从零到无穷的积分，我们必须理解这种在**无界区间上的积分**。

**反常积分（Convergence/Divergence，收敛/发散）：** 反常积分是通过有限区间上的积分取极限来定义的。 $$ \int_{a}^{\infty} f(t) dt = \lim_{A \to \infty} \int_{a}^{A} f(t) dt \quad $$ 如果当 $A \to \infty$ 时，这个极限值存在，则称该反常积分**收敛 (converge)** 到该极限值。否则，该积分**发散 (diverge)** 或不存在。

##### 2.2 分段连续函数与指数阶 (Piecewise Continuous & Exponential Order)

在讨论拉普拉斯变换的存在性之前，需要了解函数必须满足的条件：

**分段连续函数 (Piecewise Continuous Function):** 一个函数 $f$ 在区间 $[\alpha, \beta]$ 上是分段连续的，如果该区间可以被有限个点分割，使得：

1. $f$ 在每个**开子区间**内是连续的。
2. 当从子区间内部趋近每个端点时，$f$ 趋向于一个**有限的极限**。

**直觉：** 分段连续函数在其区间内除了有限个**跳跃不连续点 (jump discontinuities)** 之外，都是连续的。对于任何分段连续函数，它在有限区间 $[a, A]$ 上的定积分是一定存在的。

**指数阶 (Exponential Order):** 如果函数 $f(t)$ 满足以下条件，则称其为**指数阶**：存在正实数常数 $K$ 和 $M$，以及实常数 $a$，使得当 $t \geq M$ 时，满足不等式： $$ |f(t)| \leq K e^{at} \quad $$ **直觉（为什么需要指数阶？）**：这个条件是确保拉普拉斯变换能够**收敛**的关键。它要求函数 $f(t)$ 的增长速度不能比某个指数函数 $K e^{at}$ 快。例如，函数 $f(t) = e^{t^2}$ 增长得太快，无论 $K$ 和 $a$ 取多大，它都不是指数阶的。

##### 2.3 积分变换与拉普拉斯变换 (Integral Transform & Laplace Transform)

**积分变换 (Integral Transform):** 这是一种一般形式的数学关系： $$ F(s) = \int_{\alpha}^{\beta} K(s, t) f(t) dt \quad $$ 其中 $K(s, t)$ 是一个已知的函数，称为**变换的核 (kernel)**。该关系将函数 $f$ 转换成了另一个函数 $F$，而 $F$ 被称为 $f$ 的**变换 (transform)**。

**拉普拉斯变换 (Laplace Transform):** 拉普拉斯变换是积分变换的一个特例。它以 $K(s, t) = e^{-st}$ 作为核，积分下限为 0，上限为 $\infty$。

**拉普拉斯变换的存在定理：** 如果 $f(t)$ 是分段连续的，并且是指数阶的（满足上述 $|f(t)| \leq K e^{at}$ 的条件），那么它的拉普拉斯变换 $F(s)$ 在 $s > a$ 时存在。

**线性算子 (Linear Operator):** 拉普拉斯变换是一个**线性算子**。这意味着如果 $f_1$ 和 $f_2$ 的拉普拉斯变换存在，那么常数倍函数之和的变换等于各自变换的常数倍之和。 $$\mathcal{L}{c_1 f_1(t) + c_2 f_2(t)} = c_1\mathcal{L}{f_1(t)} + c_2\mathcal{L}{f_2(t)}$$

#### 3. 关键数学公式 (Formulas)

1. **反常积分的定义 (Definition of Improper Integral):** $$\int_{a}^{\infty} f(t) dt = \lim_{A \to \infty} \int_{a}^{A} f(t) dt$$
2. **拉普拉斯变换的定义 (Definition of the Laplace Transform):** $$\mathcal{L}{f(t)} = F(s) = \int_{0}^{\infty} e^{-st} f(t) dt$$
3. **拉普拉斯变换的线性性质 (Linearity Property):** $$\mathcal{L}{c_1 f_1(t) + c_2 f_2(t)} = c_1\mathcal{L}{f_1(t)} + c_2\mathcal{L}{f_2(t)}$$
4. **收敛性比较定理 (Comparison Theorem):** 如果 $f$ 在 $t \geq a$ 时分段连续，且当 $t \geq M$ 时 $|f(t)| \leq g(t)$，并且 $\int_{M}^{\infty} g(t) dt$ 收敛，那么 $\int_{a}^{\infty} f(t) dt$ 也收敛。 如果 $f(t) \geq g(t) \geq 0$ 且 $\int_{M}^{\infty} g(t) dt$ 发散，那么 $\int_{a}^{\infty} f(t) dt$ 也发散。

#### 4. 例题解析 (Example Walkthroughs)

本节通过三个例子复习了反常积分，并通过五个例子计算了基本函数的拉普拉斯变换。

##### 4.1 反常积分的计算例题

**例 1：判断 $\int_{1}^{\infty} \frac{dt}{t}$ 是否收敛。**

- 解题逻辑：
  1. 根据定义，计算有限积分 $\int_{1}^{A} \frac{dt}{t}$，结果是 $\ln t$ 在 $[1, A]$ 上的值，即 $\ln A - \ln 1 = \ln A$。
  2. 求极限 $\lim_{A \to \infty} \ln A$。
  3. 由于该极限趋向于 $\infty$，因此该反常积分**发散**。

**例 2：计算 $\int_{0}^{\infty} e^{ct} dt$ 并判断其收敛条件。**

- 解题逻辑：
  1. 假设 $c \neq 0$，计算 $\int_{0}^{A} e^{ct} dt$，结果是 $\frac{e^{ct}}{c}$ 在 $[0, A]$ 上的值，即 $\frac{1}{c}(e^{cA} - e^0) = \frac{1}{c}(e^{cA} - 1)$。
  2. 分析 $\lim_{A \to \infty} \frac{1}{c}(e^{cA} - 1)$：
     - 若 $c < 0$，则 $e^{cA} \to 0$，积分收敛于 $-1/c$。
     - 若 $c > 0$，则 $e^{cA} \to \infty$，积分发散。
  3. 若 $c = 0$，被积函数为 1。$\int_{0}^{A} 1 dt = A$。极限 $A \to \infty$，因此积分再次**发散**。

**例 3：找到使 $\int_{1}^{\infty} t^{-p} dt$ 收敛的所有 $p$ 值。**

- 解题逻辑 (假设 $p \neq 1$)：
  1. 计算 $\int_{1}^{A} t^{-p} dt$，结果是 $\frac{t^{1-p}}{1-p}$ 在 $[1, A]$ 上的值，即 $\frac{1}{1-p}(A^{1-p} - 1)$。
  2. 分析 $\lim_{A \to \infty} \frac{1}{1-p}(A^{1-p} - 1)$：
     - 若 $p > 1$，则 $1-p < 0$。 $A^{1-p} \to 0$。积分收敛于 $\frac{-1}{1-p} = \frac{1}{p-1}$。
     - 若 $p < 1$，则 $1-p > 0$。 $A^{1-p} \to \infty$。积分发散。
  3. 结合例 1 ($p=1$ 时发散)，最终结论是当 $p > 1$ 时收敛，当 $p \leq 1$ 时发散。

##### 4.2 拉普拉斯变换的计算例题

**例 4：求 $\mathcal{L}{1}$。**

- 解题逻辑：
  1. 应用拉普拉斯变换定义：$\mathcal{L}{1} = \int_{0}^{\infty} e^{-st} (1) dt$。
  2. 这是例 2 的特殊情况，其中 $c = -s$。
  3. 根据例 2 的收敛条件 ($c < 0$)，要求 $-s < 0$，即 $s > 0$。
  4. 收敛结果为 $-1/c = -1/(-s) = 1/s$。
- **结果：** $\mathcal{L}{1} = \frac{1}{s}$, $s > 0$。

**例 5：求 $\mathcal{L}{e^{at}}$。**

- 解题逻辑：
  1. 应用定义：$\mathcal{L}{e^{at}} = \int_{0}^{\infty} e^{-st} e^{at} dt = \int_{0}^{\infty} e^{-(s-a)t} dt$。
  2. 这再次是例 2 的形式，其中 $c = -(s-a)$。
  3. 要求积分收敛，必须满足 $c < 0$，即 $-(s-a) < 0$，等价于 $s - a > 0$，或 $s > a$。
  4. 收敛结果为 $-1/c = -1/(-(s-a)) = 1/(s-a)$。
- **结果：** $\mathcal{L}{e^{at}} = \frac{1}{s-a}$, $s > a$。

**例 6：求分段函数 $f(t)$ 的拉普拉斯变换。**

- **函数定义：** $f(t) = 1$ (当 $0 \le t < 1$)； $f(t) = 0$ (当 $t > 1$)。
- 解题逻辑：
  1. 由于 $f(t)$ 是分段连续函数，将无限积分 $\int_{0}^{\infty}$ 拆分成 $f(t)$ 定义的区间：$\int_{0}^{\infty} e^{-st} f(t) dt = \int_{0}^{1} e^{-st} (1) dt + \int_{1}^{\infty} e^{-st} (0) dt$。
  2. 第二个积分项为零。只需计算第一个定积分 $\int_{0}^{1} e^{-st} dt$。
  3. 计算结果为 $\frac{-e^{-st}}{s} \big|_0^1 = \frac{-e^{-s}}{s} - \frac{-e^{-0}}{s} = \frac{1 - e^{-s}}{s}$。
- **洞察：** 在 $t=1$ 处的函数值（本例中设为常数 $k$）**不会影响**拉普拉斯变换的结果。对于积分而言，不连续点的单个函数值无关紧要。
- **结果：** $\mathcal{L}{f(t)} = \frac{1 - e^{-s}}{s}$, $s > 0$。

**例 7：求 $\mathcal{L}{\sin(at)}$。**

- 解题逻辑：
  1. 应用定义：$F(s) = \int_{0}^{\infty} e^{-st} \sin(at) dt$。
  2. 由于被积函数涉及指数函数和三角函数，需要使用**两次分部积分法 (integration by parts)**。
  3. 第一次分部积分后，得到一个包含 $\int_{0}^{\infty} e^{-st} \cos(at) dt$ 的表达式：$F(s) = \frac{1}{a} - \frac{s}{a} \int_{0}^{\infty} e^{-st} \cos(at) dt$。
  4. 对剩余的 $\cos(at)$ 积分项进行第二次分部积分，代入结果后发现表达式中再次出现了原始的 $F(s)$：$F(s) = \frac{1}{a} - \frac{s^2}{a^2} F(s)$。
  5. 将 $F(s)$ 视作代数变量，求解此代数方程。
- **结果：** $F(s) = \frac{a}{s^2 + a^2}$, $s > 0$。

**例 8：求 $\mathcal{L}{5e^{-2t} - 3\sin(4t)}$。**

- 解题逻辑：
  1. 利用拉普拉斯变换的**线性性质**（公式 6），将复杂变换拆解为已知变换的组合： $$\mathcal{L}{f(t)} = 5\mathcal{L}{e^{-2t}} - 3\mathcal{L}{\sin(4t)}$$
  2. 利用**例 5** 的结果 $\mathcal{L}{e^{at}} = \frac{1}{s-a}$ (此处 $a=-2$): $$5\mathcal{L}{e^{-2t}} = 5 \left(\frac{1}{s - (-2)}\right) = \frac{5}{s+2}$$
  3. 利用**例 7** 的结果 $\mathcal{L}{\sin(at)} = \frac{a}{s^2+a^2}$ (此处 $a=4$): $$3\mathcal{L}{\sin(4t)} = 3 \left(\frac{4}{s^2 + 4^2}\right) = \frac{12}{s^2+16}$$
  4. 组合得到最终结果。
- **结果：** $\mathcal{L}{f(t)} = \frac{5}{s+2} - \frac{12}{s^2+16}$, $s > 0$。

------

**总结类比：**

您可以将拉普拉斯变换想象成一种**数学翻译机**。我们处理复杂的微分方程 (时域 $t$ 中的难题)，就像阅读一篇用晦涩古语写成的文章。通过拉普拉斯变换 (翻译过程)，我们将其转换为代数方程 ($s$ 域中的简单数学)，就像将古语文章翻译成了现代白话文。我们很容易在白话文中找到答案 ($F(s)$)，然后再通过**反演变换** (逆向翻译)，将答案重新变回时域 ($f(t)$)，得到微分方程的最终解。**变换的成功关键在于 $e^{-st}$ 这个“翻译核”，因为它正好对应了常系数线性微分方程的自然解形式。**



# 6.2 Solution of Initial Value Problems

#### 1. 核心概念 (Core Concept)

本节的核心主题是：**利用拉普拉斯变换解决具有常系数的线性微分方程的初值问题 (Solution of Initial Value Problems)**。

**关键基础：** 该方法的基础在于能够将函数 $f(t)$ 的导数 $f'(t)$ 的拉普拉斯变换 $\mathcal{L}{f'(t)}$ 与原函数 $f(t)$ 的拉普拉斯变换 $\mathcal{L}{f(t)}$ 之间建立起简单的关系。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 导数的拉普拉斯变换 (Transform of Derivatives)

为了使拉普拉斯变换能够应用于微分方程，我们必须首先确定导数（如 $y', y''$ 等）的变换形式。

**定理 6.2.1 存在的条件：** 函数 $f(t)$ 必须满足以下条件才能保证 $\mathcal{L}{f'(t)}$ 存在：

1. $f$ 在任何区间 $0 \le t \le A$ 上是**连续**的。
2. $f'$ 在任何区间 $0 \le t \le A$ 上是**分段连续**的。
3. $f$ 必须是**指数阶**的，即存在常数 $K, a, M$ 使得当 $t \ge M$ 时，满足 $|f(t)| \le K e^{at}$。

**证明导数变换的直觉：** 为了证明 $\mathcal{L}{f'(t)}=s\mathcal{L}{f(t)} - f(0)$，我们从定义出发： $$ \int_{0}^{A} e^{-st} f'(t) dt \quad $$ 这个有限积分是通过**分部积分法 (integration by parts)** 来计算的。 由于 $f(t)$ 是连续的，尽管 $f'(t)$ 可能有不连续点 $t_1, t_2, \dots, t_k$，但通过分部积分，这些不连续点处的求值项会相互抵消。 最终，积分结果可以写为： $$ \int_{0}^{A} e^{-st} f'(t) dt = e^{-sA} f(A) - f(0) + s \int_{0}^{A} e^{-st} f(t) dt \quad \text{(2)}, $$ 当我们取极限 $A \to \infty$ 时，由于 $f(t)$ 是指数阶的，只要 $s > a$，边界项 $e^{-sA} f(A)$ 就会趋向于 0。 因此，左侧的极限就是 $\mathcal{L}{f'(t)}$，右侧的极限就是 $s\mathcal{L}{f(t)} - f(0)$,。

##### 2.2 逆拉普拉斯变换 (Inverse Laplace Transform)

**定义：** 如果 $Y(s) = \mathcal{L}{y(t)}$，则称 $y(t)$ 是 $Y(s)$ 的**逆拉普拉斯变换 (inverse Laplace transform)**。我们使用符号 $\mathcal{L}^{-1}{Y(s)}$ 来表示逆变换。

**线性性质：** 逆拉普拉斯变换也是一个**线性算子**。如果 $F(s)$ 可以写成 $F(s) = F_1(s) + F_2(s) + \cdots + F_n(s)$ 的和，那么： $$\mathcal{L}^{-1}{F(s)} = \mathcal{L}^{-1}{F_1(s)} + \mathcal{L}^{-1}{F_2(s)} + \cdots + \mathcal{L}^{-1}{F_n(s)}$$ 在许多问题中，利用**分式分解 (Partial fraction expansion)** 将给定的变换分解成已知逆变换的函数之和是非常方便的。

**方法论的四大特点（核心优势）：**

1. **微分到代数：** 末知函数 $y(t)$ 的变换 $Y(s)$ 是通过求解一个**代数方程**（如方程 (10) 或 (15)）而不是微分方程来找到的。这是拉普拉斯变换解决线性常系数微分方程的关键。
2. **自动满足初值：** 求解过程中自动得到了满足给定**初始条件**的解，无需像传统方法那样在通解中确定任意常数的值。
3. **统一处理：** **非齐次方程**的处理方式与齐次方程完全相同。
4. **适用于高阶：** 该方法可以同样应用于高阶方程，只要解满足推论 6.2.2 规定的条件。

**注意：特征多项式与分式分解** 在求解 $Y(s)$ 时，分母中出现的 $as^2 + bs + c$ **正是**微分方程的**特征多项式**。因此，在使用分式分解求 $y(t)$ 时，我们仍然需要对这个特征多项式进行因式分解，这与传统方法中寻找特征根是等价的。

##### 2.3 物理应用 (Physical Applications)

拉普拉斯变换最主要的初级应用在于**机械振动**和**电路分析**。

- **弹簧-质量系统 (Spring-mass system)：** 控制方程是 $m \frac{d^2u}{dt^2} + \gamma \frac{du}{dt} + ku = F(t)$。
- **LRC 电路 (LRC circuit)：** 控制方程是 $L \frac{d^2Q}{dt^2} + R \frac{dQ}{dt} + \frac{1}{C} Q = E(t)$。 这些物理问题虽然涉及不同的常数和变量，但在数学上是**相同的微分方程**。

#### 3. 关键数学公式 (Formulas)

1. **一阶导数的拉普拉斯变换 (Theorem 6.2.1):** $$\mathcal{L}{ f'(t) } = s\mathcal{L}{ f(t) } - f(0), \quad s > a \text{ (1),}$$
2. **二阶导数的拉普拉斯变换 (Extension of Theorem 6.2.1):** $$\mathcal{L}{ f''(t) } = s^2\mathcal{L}{ f(t) } - s f(0) - f'(0) \quad \text{(3),}$$
3. **$n$ 阶导数的拉普拉斯变换 (Corollary 6.2.2):** 假设 $f$ 及其前 $n-1$ 阶导数连续，并且 $f^{(n)}$ 分段连续且它们都是指数阶的。 $$\mathcal{L}{ f^{(n)}(t) } = s^n\mathcal{L}{ f(t) } - s^{n-1} f(0) - \cdots - s f^{(n-2)}(0) - f^{(n-1)}(0) \quad \text{(4),}$$
4. **$\mathcal{L}{t^p}$ 涉及伽马函数 $\Gamma(p)$ (Gamma Function Identity):** 对于 $p > -1$， $$\mathcal{L}{t^p} = \frac{\Gamma(p+1)}{s^{p+1}}, \quad s > 0 \quad \text{,}$$
   - **特殊情况：** 当 $p$ 是正整数 $n$ 时，由于 $\Gamma(n+1) = n!$，公式简化为： $$\mathcal{L}{t^n} = \frac{n!}{s^{n+1}}, \quad s > 0 \quad \text{,}$$
   - **半整数情况：** 利用 $\int_{0}^{\infty} e^{-x^2} dx = \frac{\sqrt{\pi}}{2}$ 和伽马函数的性质，可得： $$\mathcal{L}{t^{-1/2}} = \frac{\sqrt{\pi}}{\sqrt{s}}, \quad s > 0 \quad \text{}$$ $$\mathcal{L}{t^{1/2}} = \frac{\sqrt{\pi}}{2s^{3/2}}, \quad s > 0 \quad \text{}$$

#### 4. 例题解析 (Example Walkthroughs)

##### 例 1：齐次二阶方程求解

**问题：** $y'' - y' - 2y = 0$，初始条件 $y(0) = 1, y'(0) = 0$。

**解题逻辑：**

1. **施加变换：** 假设解 $y(t)$ 及其导数满足推论 6.2.2 的条件。对微分方程两边应用拉普拉斯变换 $\mathcal{L}$，并利用变换的**线性性质**将其分解。
2. **引入导数公式：** 使用 Corollary 6.2.2 将 $\mathcal{L}{y''}$ 和 $\mathcal{L}{y'}$ 转化为 $Y(s) = \mathcal{L}{y}$ 的代数表达式。
3. **代入初值并求解 $Y(s)$：** 将 $y(0)=1$ 和 $y'(0)=0$ 代入所得的代数方程。通过代数操作，将 $Y(s)$ 隔离出来，得到 $Y(s) = \frac{s-1}{s^2-s-2}$。
4. **分式分解 (Partial Fractions)：** 对 $Y(s)$ 进行因式分解 $s^2-s-2 = (s-2)(s+1)$。然后利用分式分解，将 $Y(s)$ 写成 $\frac{a}{s-2} + \frac{b}{s+1}$ 的形式。
5. 确定系数 $a, b$：
   - 通过使等式 $s-1 = a(s+1) + b(s-2)$ 对所有 $s$ 成立，设置 $s=2$，得到 $a=1/3$。
   - 设置 $s=-1$，得到 $b=2/3$,。
   - 得到 $Y(s) = \frac{1/3}{s-2} + \frac{2/3}{s+1}$。
6. **求逆变换：** 利用逆变换的线性性质 $\mathcal{L}^{-1}$ 和基本变换公式 $\mathcal{L}^{-1}{\frac{1}{s-a}} = e^{at}$，将 $Y(s)$ 转换回时域解 $y(t)$。

**结果：** $y(t) = \frac{1}{3}e^{2t} + \frac{2}{3}e^{-t}$。

##### 例 2：非齐次二阶方程求解

**问题：** $y'' + y = \sin(2t)$，初始条件 $y(0)=2, y'(0)=1$。

**解题逻辑：**

1. **施加变换：** 对方程两边施加 $\mathcal{L}$。右侧 $\mathcal{L}{\sin(2t)}$ 使用表格 (Table 6.2.1, Line 5) 得到 $\frac{2}{s^2+4}$。

2. **求解 $Y(s)$：** 代入初始条件 $y(0)=2, y'(0)=1$，解代数方程，得到 $Y(s) = \frac{2s^3 + s^2 + 8s + 6}{(s^2+1)(s^2+4)}$。

3. **分式分解 (Partial Fractions)：** 由于分母包含两个不可约的二次项，分解形式需要包含线性的分子项 $\frac{as+b}{s^2+1} + \frac{cs+d}{s^2+4}$。

4. **确定系数 $a, b, c, d$：** 将右侧通分并展开分子，得到一个 $s$ 的三次多项式。通过**比较 $s$ 的同次幂的系数**，建立一个四元线性方程组。解此方程组，得到 $a=2, c=0, b=5/3, d=-2/3$。

5. 求逆变换：

    将 $Y(s)$ 写成 $Y(s) = 2\frac{s}{s^2+1} + \frac{5/3}{s^2+1} - \frac{2/3}{s^2+4}$。

   - 第一项 $\frac{s}{s^2+1}$ 对应 $\cos(t)$ (Line 6)。
   - 第二项 $\frac{1}{s^2+1}$ 对应 $\sin(t)$ (Line 5)。
   - 第三项 $\frac{1}{s^2+4} = \frac{1}{2}\frac{2}{s^2+2^2}$ 对应 $\frac{1}{2}\sin(2t)$。

6. **组合解：** 组合得到最终解 $y = 2 \cos t + \frac{5}{3} \sin t - \frac{1}{3} \sin(2t)$。

##### 例 3：高阶（四阶）齐次方程求解

**问题：** $y^{(4)} - y = 0$，初始条件 $y(0) = 0, y'(0) = 1, y''(0) = 0, y'''(0) = 0$,。

**解题逻辑：**

1. **施加变换：** 对 $y^{(4)}$ 应用推论 6.2.2 的公式。

2. **求解 $Y(s)$：** 代入四个初始条件。方程简化后，解出 $Y(s) = \frac{s^2}{s^4-1}$。

3. **分式分解：** 分母因式分解为 $(s^2-1)(s^2+1)$。采用分解形式 $\frac{as+b}{s^2-1} + \frac{cs+d}{s^2+1}$。

4. 确定系数：

    目标是使 $(as+b)(s^2+1) + (cs+d)(s^2-1) = s^2$ 成立。

   - 代入 $s=1$ 和 $s=-1$ 快速解出 $a=0, b=1/2$。
   - 代入 $s=0$ 或比较 $s$ 的三次方系数，解出 $c=0, d=1/2$。

5. 求逆变换：

    得到 $Y(s) = \frac{1/2}{s^2-1} + \frac{1/2}{s^2+1}$。

   - 第一项 $\frac{1}{s^2-1}$ 对应 $\sinh(t)$ (Line 7)。
   - 第二项 $\frac{1}{s^2+1}$ 对应 $\sin(t)$ (Line 5)。

**结果：** $y(t) = \frac{1}{2} (\sinh t + \sin t)$。





# 6.3 Step Functions

#### 1. 核心概念 (Core Concept)

本节的核心目的是引入工具来处理**不连续或脉冲强迫函数 (discontinuous or impulsive forcing functions)** 驱动的线性微分方程。

核心工具是：**单位阶跃函数 (Unit Step Function)**，也称为 **Heaviside 函数**。在此基础上，本节确立了两个关键定理：

1. **$t$ 域平移定理 (First Translation Theorem)**：关于函数在时间轴上的平移。
2. **$s$ 域平移定理 (Second Translation Theorem)**：关于 $s$ 域中的平移。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 单位阶跃函数 (Unit Step Function)

**定义：** 单位阶跃函数 $u_c(t)$ 的定义如下： $$ u_c(t) = \begin{cases} 0, & t < c \ 1, & t \ge c \end{cases} \quad \text{(1)} $$ 其中 $c$ 是一个非负常数。

**直觉：** $u_c(t)$ 就像一个在时间 $t=c$ 处**开启的开关**。

- 当 $t$ 小于 $c$ 时，函数值为 0（“关闭”）。
- 当 $t$ 大于或等于 $c$ 时，函数值为 1（“开启”）。
- **注意：** $u_c(t)$ 是一个分段连续函数。对于这类函数，它在不连续点 $t=c$ 处的函数值（在本定义中是 1）对于积分和拉普拉斯变换的结果通常是无关紧要的。
- **反向开关：** 函数 $1 - u_c(t)$ 表示一个在时间 $t=c$ 处**关闭的开关**。

##### 2.2 构造分段函数（以阶跃函数表示）

任何分段常数函数都可以通过阶跃函数的组合来表示。

- **矩形脉冲 (Rectangular Pulse)：** 例如，$u_{\pi}(t) - u_{2\pi}(t)$。这个函数在 $t=\pi$ 处从 0 跳到 1，然后在 $t=2\pi$ 处从 1 跳回 0。这代表了一个只在 $(\pi, 2\pi)$ 时间区间内“开启”的信号。
- **表示复杂分段函数：** 我们可以通过在每个**跳跃点**上加上或减去一个阶跃函数 $u_c(t)$ 的倍数来构造任意的分段常数函数。这个倍数必须等于该跳跃点处的值的变化量,。

##### 2.3 $t$ 域中的平移（定理 6.3.1）

**定义：** 考虑一个新函数 $g(t) = u_c(t) f(t-c)$。 $$ g(t) = \begin{cases} 0, & t < c \ f(t-c), & t \ge c \end{cases} \quad \text{(7)} $$

**直觉：** $g(t)$ 是将原始函数 $f(t)$ **向右平移 $c$ 个单位**，并在 $t<c$ 时保持为零。这意味着 $f(t)$ 的效应被延迟到时间 $c$ 才开始。

**定理直觉：** **函数在 $t$ 域中的平移（乘以 $u_c(t)$）等价于它的拉普拉斯变换 $F(s)$ 乘以一个指数因子 $e^{-cs}$**。指数因子 $e^{-cs}$ 就是延迟的代数表示。

##### 2.4 $s$ 域中的平移（定理 6.3.2）

**直觉：** **函数在 $t$ 域中乘以指数函数 $e^{ct}$ 等价于将 $F(s)$ 中的所有 $s$ 替换为 $(s-c)$**。这种 $s$ 域的平移是处理 $s$ 域分母中包含形如 $(s-c)^2 + a^2$ 结构的关键，通常在配方法 (completing the square) 之后使用。

#### 3. 关键数学公式 (Formulas)

1. **单位阶跃函数的拉普拉斯变换：** $$\mathcal{L}{u_c(t)} = \frac{e^{-cs}}{s}, \quad s > 0$$
2. **$t$ 域平移定理 (第一平移定理，Theorem 6.3.1)：** $$\mathcal{L}{u_c(t) f(t - c)} = e^{-cs} F(s), \quad s > a$$
3. **逆 $t$ 域平移定理：** $$\mathcal{L}^{-1}{e^{-cs} F(s)} = u_c(t) f(t - c)$$
4. **$s$ 域平移定理 (第二平移定理，Theorem 6.3.2)：** $$\mathcal{L}{e^{ct} f(t)} = F(s - c), \quad s > a + c$$
5. **逆 $s$ 域平移定理：** $$\mathcal{L}^{-1}{F(s - c)} = e^{ct} f(t)$$

#### 4. 例题解析 (Example Walkthroughs)

##### 例 2：用 $u_c(t)$ 表示分段函数 (Example 2)

**目标：** 将一个分段常数函数 $f(t)$ 转化为阶跃函数的组合。

**解题逻辑：**

1. **起始值：** 函数从 $t=0$ 开始的初始值为 2。

2. $t=4$ 处的跳跃：

    在 $t=4$ 处，函数值从 2 跳到 5，变化量为 $5 - 2 = 3$ 个单位。因此，我们添加 $3u_4(t)$。

   - 此时函数表达式 $f_2(t) = 2 + 3u_4(t)$。

3. $t=7$ 处的跳跃：

    在 $t=7$ 处，函数值从 5 跳到 $-1$，变化量为 $-1 - 5 = -6$ 个单位。因此，我们添加 $-6u_7(t)$,。

   - 此时函数表达式 $f_3(t) = 2 + 3u_4(t) - 6u_7(t)$。

4. **$t=9$ 处的跳跃：** 在 $t=9$ 处，函数值从 $-1$ 跳到 1，变化量为 $1 - (-1) = 2$ 个单位。因此，我们添加 $2u_9(t)$。

**最终表达式：** $f(t) = 2 + 3u_4(t) - 6u_7(t) + 2u_9(t)$。

##### 例 3：利用 $t$ 域平移求变换 (Example 3)

**目标：** 求分段函数 $f(t)$ 的拉普拉斯变换 $\mathcal{L}{f(t)}$。

**解题逻辑：**

1. 重写函数：

    首先将 $f(t)$ 拆分为两个部分：一个在 $t \ge 0$ 时都存在的项，以及一个只在 $t \ge \pi/4$ 之后出现的项 $g(t)$。

   - $f(t) = \sin t + g(t)$，其中 $g(t) = u_{\pi/4}(t) \cos(t - \pi/4)$。

2. **应用线性性质：** $\mathcal{L}{f(t)} = \mathcal{L}{\sin t} + \mathcal{L}{g(t)}$。

3. 应用 $t$ 域平移定理 (6.3.1)：

    对于 $g(t) = u_c(t) f(t-c)$ 的形式，其中 $c = \pi/4$，原函数 $f(t)$ 对应于 $\cos t$。

   - $\mathcal{L}{g(t)} = \mathcal{L}{u_{\pi/4}(t) \cos(t - \pi/4)} = e^{-\pi s/4} \mathcal{L}{\cos t}$。

4. **代入已知变换：** 使用已知的 $\mathcal{L}{\sin t} = \frac{1}{s^2+1}$ 和 $\mathcal{L}{\cos t} = \frac{s}{s^2+1}$。

5. **组合结果：** 将各项加在一起，并进行代数简化。

**最终结果：** $\mathcal{L}{f(t)} = \frac{1}{s^2 + 1} + e^{-\pi s/4} \frac{s}{s^2 + 1} = \frac{1 + se^{-\pi s/4}}{s^2 + 1}$。

##### 例 4：利用 $t$ 域平移求逆变换 (Example 4)

**目标：** 求 $F(s) = \frac{1}{s^2} - \frac{e^{-2s}}{s^2}$ 的逆拉普拉斯变换 $f(t)$。

**解题逻辑：**

1. **应用逆变换的线性性质：** 将 $F(s)$ 拆分为两项的逆变换之差。 $$f(t) = \mathcal{L}^{-1}\left\{(\frac{1}{s^2}\right\} - \mathcal{L}^{-1}\left\{e^{-2s} \frac{1}{s^2}\right\} \quad \text{(12)}$$

2. **计算第一项：** 我们知道 $\mathcal{L}{t} = \frac{1!}{s^{1+1}} = \frac{1}{s^2}$，所以第一项的逆变换是 $t$。

3. 计算第二项：

    这项符合逆 $t$ 域平移定理 $e^{-cs} F(s)$ 的形式，其中 $c=2$ 且 $F(s) = \frac{1}{s^2}$。

   - 首先求 $F(s)$ 的逆变换：$\mathcal{L}^{-1}{F(s)} = \mathcal{L}^{-1}{\frac{1}{s^2}} = t$。
   - 根据定理，$\mathcal{L}^{-1}{e^{-2s} F(s)} = u_2(t) f(t-2) = u_2(t) (t-2)$。

4. 组合并分段表示：

   $$f(t) = t - u_2(t) (t-2) \quad \text{(12)}$$

   - 当 $0 \le t < 2$ 时，$u_2(t)=0$，所以 $f(t) = t - 0 = t$。
   - 当 $t \ge 2$ 时，$u_2(t)=1$，所以 $f(t) = t - (t-2) = 2$。

**最终结果：** $f(t) = \begin{cases} t, & 0 \le t < 2 \\ 2, & t \ge 2 \end{cases}$

##### 例 5：利用 $s$ 域平移求逆变换 (Example 5)

**目标：** 求 $G(s) = \frac{1}{s^2 - 4s + 5}$ 的逆拉普拉斯变换 $g(t)$。

**解题逻辑：**

1. **配方法：** $G(s)$ 的分母是一个二次项，需要通过**配方法**将其转化为 $(s-c)^2 + a^2$ 的形式，以便应用 $s$ 域平移定理。 $$s^2 - 4s + 5 = (s^2 - 4s + 4) + 1 = (s-2)^2 + 1 \quad \text{(14)}$$
2. **识别 $F(s-c)$：** 重写 $G(s)$： $$G(s) = \frac{1}{(s-2)^2 + 1}$$ 这符合 $F(s-c)$ 的形式，其中 $c=2$，而原函数 $F(s) = \frac{1}{s^2 + 1}$。
3. **求 $F(s)$ 的逆变换：** 我们知道 $\mathcal{L}^{-1}{F(s)} = \mathcal{L}^{-1}{\frac{1}{s^2+1}} = \sin t$。
4. **应用 $s$ 域平移定理 (6.3.2)：** 根据 $\mathcal{L}^{-1}{F(s-c)} = e^{ct} f(t)$，此处 $c=2$ 且 $f(t)=\sin t$。

**最终结果：** $g(t) = e^{2t} \sin t$。

------

**学习启示 (Metaphor):**

阶跃函数 $u_c(t)$ 和平移定理，就像是给拉普拉斯变换这架“数学翻译机”增加了处理**延时和调频**的功能。

- **$t$ 域平移** ($u_c(t) f(t-c)$) 就像给信号增加了**延迟器**：它保证信号在时间 $c$ 之前保持静默。在 $s$ 域，这个延迟效应是通过乘以 $e^{-cs}$ 来实现的。
- **$s$ 域平移** ($F(s-c)$) 就像给信号增加了**调频器**：通过在 $t$ 域中乘以一个指数函数 $e^{ct}$ 来“调制”信号的幅值，从而使 $s$ 域的表达式变得更加简洁，更容易识别基础函数的拉普拉斯变换。





# 6.4 Differential Equations with Discontinuous Forcing Functions

#### 1. 核心概念 (Core Concept)

本节的核心主题是：**利用拉普拉斯变换和单位阶跃函数**，系统、便捷地求解具有**不连续强迫项**（非齐次项）的常系数线性微分方程初值问题。

**直觉：** 在物理系统中，例如电路中电压的突然开关，或机械系统中作用力的突然移除，都会导致强迫函数 $g(t)$ 的不连续性。传统的分段求解法（即在每个连续区间内解微分方程，然后利用区间端点的连续性条件确定常数）非常繁琐。拉普拉斯变换提供了一个**统一的代数方法**来处理整个时间域的问题，自动考虑了初值和不连续点的影响。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 不连续强迫函数与拉普拉斯方法的优势

**不连续强迫函数 (Discontinuous Forcing Function)：** 指微分方程右侧的非齐次项 $g(t)$ 在某些时间点上存在**跳跃不连续**。

**应用流程回顾：**

1. **用阶跃函数表示 $g(t)$：** 首先，利用单位阶跃函数 $u_c(t)$ 将不连续强迫函数 $g(t)$ 写作单一的解析表达式（如例 1 中的 $g(t) = u_5(t) - u_{20}(t)$）。
2. **施加变换：** 对微分方程两边施加拉普拉斯变换，利用第 6.2 节的导数变换公式和初始条件，得到关于 $Y(s)$ 的代数方程。
3. **应用平移定理：** 利用第 6.3 节的 $t$ 域平移定理 $\mathcal{L}{u_c(t) f(t-c)} = e^{-cs} F(s)$ 来处理 $g(t)$ 变换后产生的指数因子 $e^{-cs}$。
4. **求逆变换：** 通过分式分解将 $Y(s)$ 拆分，并应用**逆 $t$ 域平移定理** $\mathcal{L}^{-1}{e^{-cs} F(s)} = u_c(t) f(t - c)$，将 $s$ 域的解 $Y(s)$ 转换回 $t$ 域解 $y(t)$。

##### 2.2 解的连续性分析 (Continuity of the Solution)

**关键洞察：** 即使强迫函数 $g(t)$ 在 $t=c$ 处有跳跃不连续，**微分方程的解 $y(t)$ 及其低于最高阶导数的所有导数 ($y'(t)$ 等) 仍然是连续的**,。

**解释（平衡跳跃）：**

- 强迫函数 $g(t)$ 的跳跃不连续性必须由微分方程左侧的项来平衡。
- 对于形如 $y'' + p(t)y' + q(t)y = g(t)$ 的二阶方程，如果 $g(t)$ 在某点处发生跳跃，那么最高阶导数 $y''(t)$ 也会在同一点发生跳跃，且**跳跃量与 $g(t)$ 保持一致** (如果 $y''$ 的系数是 1)。
- 例如，在例 1 中 $g(t)$ 在 $t=5$ 处跳跃了 $+1$。计算结果显示 $y''(t)$ 在 $t=5$ 处跳跃了 $+1/2$，正好平衡了 $2y''$ 左侧的 $2y''$ 项（因为 $2 \times (+1/2) = +1$）。

#### 3. 关键数学公式 (Formulas)

1. **强迫函数 $g(t)$ 的一般形式（矩形脉冲）：** $$g(t) = u_{t_1}(t) - u_{t_2}(t) = \begin{cases} 1, & t_1 \le t < t_2 \ 0, & 0 \le t < t_1 \text{ or } t \ge t_2 \end{cases} \quad \text{(2),}$$
2. **$Y(s)$ 的一般形式（含指数因子）：** 对于 $Y(s) = e^{-cs} H(s)$ 的形式，其逆变换使用逆 $t$ 域平移定理。 $$\mathcal{L}^{-1}{e^{-cs} H(s)} = u_c(t) h(t - c) \quad \text{(7),}$$
3. **解 $y(t)$ 的一般结构：** 若 $Y(s) = (e^{-t_1 s} - e^{-t_2 s}) H(s)$ 且 $h(t) = \mathcal{L}^{-1}{H(s)}$，则解为： $$y(t) = u_{t_1}(t)h(t - t_1) - u_{t_2}(t)h(t - t_2) \quad \text{(7),}$$

#### 4. 例题解析 (Example Walkthroughs)

##### 例 1：矩形脉冲强迫项 (Unit Voltage Pulse)

**问题：** 求解 $2y'' + y' + 2y = g(t)$，初值 $y(0)=0, y'(0)=0$。其中 $g(t) = u_5(t) - u_{20}(t)$。

**解题逻辑：**

1. **施加变换：** 对微分方程施加拉普拉斯变换。由于初始条件 $y(0)=0, y'(0)=0$ 为零，导数变换简化，方程变为代数形式。 $$\mathcal{L}{2y'' + y' + 2y} = (2s^2 + s + 2) Y(s)$$ $$\mathcal{L}{g(t)} = \mathcal{L}{u_5(t)} - \mathcal{L}{u_{20}(t)} = \frac{e^{-5s}}{s} - \frac{e^{-20s}}{s} = \frac{1}{s} (e^{-5s} - e^{-20s})$$

2. **求解 $Y(s)$：** 解出 $Y(s)$： $$Y(s) = \frac{e^{-5s} - e^{-20s}}{s(2s^2 + s + 2)} = (e^{-5s} - e^{-20s}) H(s) \quad \text{(4), (5)}$$ 其中 $H(s) = \frac{1}{s(2s^2 + s + 2)}$。

3. 分式分解 $H(s)$：

    对 $H(s)$ 进行分式分解，形式为 $H(s) = \frac{a}{s} + \frac{bs + c}{2s^2 + s + 2}$。

   - 确定系数得到 $a=1/2, b=-1, c=-1/2$。

4. 配方法和求逆变换 $h(t)$：

    重写 $H(s)$ 的第二项，使用配方法，将其转化为 $s$ 域平移定理适用的形式 $(s-c)^2 + a^2$。

   - $2s^2 + s + 2 = 2 \left( (s + 1/4)^2 + 15/16 \right)$。
   - 经过代数重组和拆分，将 $H(s)$ 转化为 $\frac{1}{2}\frac{1}{s}$、$\frac{s+1/4}{(s+1/4)^2 + 15/16}$ (对应 $\cos$ 项) 和 $\frac{\sqrt{15}/4}{(s+1/4)^2 + 15/16}$ (对应 $\sin$ 项) 的组合。
   - 求逆变换 $h(t)$ 得到一个常数项和指数衰减的正弦/余弦项的组合： $$h(t) = \frac{1}{2} - \frac{1}{2} \left( e^{-t/4} \cos\left(\frac{\sqrt{15}}{4} t\right) + \frac{1}{\sqrt{15}} e^{-t/4} \sin\left(\frac{\sqrt{15}}{4} t\right) \right) \quad \text{(10),}$$

5. **应用 $t$ 域平移求最终解：** 应用公式 (7) 得到 $y(t)$： $$y(t) = u_5(t)h(t - 5) - u_{20}(t)h(t - 20) \quad \text{(7),}$$

**解的物理含义分析：** 解 $y(t)$ 自动分为三个区间：

- **$0 \le t < 5$：** $u_5(t)$ 和 $u_{20}(t)$ 都为 0，系统处于静止状态 $y=0$。
- **$5 \le t < 20$：** 强迫函数 $g(t)=1$。解简化为 $y(t) = h(t-5)$,。系统响应是一个关于 $y=1/2$ 振荡的**阻尼振荡**,。
- **$t \ge 20$：** 强迫函数 $g(t)=0$。解为 $y(t) = h(t-5) - h(t-20)$。这本质上是系统在 $t=20$ 时被移除强迫项后，继续以阻尼振荡形式衰减至零。

##### 例 2：斜坡加载强迫项 (Ramp Loading)

**问题：** 求解 $y'' + 4y = g(t)$，初值 $y(0)=0, y'(0)=0$。其中 $g(t)$ 是斜坡加载 (ramp loading) 函数，它在 $t=5$ 到 $t=10$ 之间线性增加，然后保持为 1。

**解题逻辑：**

1. **用阶跃函数重写 $g(t)$：** 关键是将斜坡加载 $g(t)$ 转化为 $u_c(t)f(t-c)$ 的形式，这需要利用 $u_5(t)(t-5)$ 来启动斜坡，并利用 $u_{10}(t)(t-10)$ 在 $t=10$ 时关闭斜坡的**斜率**。 $$g(t) = \frac{1}{5} \left( u_5(t) (t-5) - u_{10}(t) (t-10) \right) \quad \text{(21),}$$
2. **施加变换：** 对微分方程施加变换，并利用初始条件： $$(s^2 + 4)Y(s) = \mathcal{L}{g(t)} = \frac{1}{5} \left( e^{-5s} \mathcal{L}{t} - e^{-10s} \mathcal{L}{t} \right)$$ （此处应用了 $\mathcal{L}{u_c(t)f(t-c)} = e^{-cs} F(s)$，其中 $f(t)=t$，故 $F(s) = 1/s^2$） $$(s^2 + 4)Y(s) = \frac{1}{5s^2} (e^{-5s} - e^{-10s})$$
3. **求解 $Y(s)$：** $$Y(s) = \frac{1}{5} (e^{-5s} - e^{-10s}) H(s) \quad \text{(22),}$$ 其中 $H(s) = \frac{1}{s^2(s^2 + 4)}$ 。
4. **分式分解 $H(s)$：** 对 $H(s)$ 进行分式分解： $$H(s) = \frac{1/4}{s^2} - \frac{1/4}{s^2 + 4} \quad \text{(25),}$$
5. 求逆变换 $h(t)$：
   - $\mathcal{L}^{-1}{1/s^2} = t$。
   - $\mathcal{L}^{-1}{\frac{1}{s^2+4}} = \frac{1}{2}\mathcal{L}^{-1}{\frac{2}{s^2+2^2}} = \frac{1}{2} \sin(2t)$。
   - 因此 $h(t) = \frac{1}{4}t - \frac{1}{8}\sin(2t)$ 。
6. **应用 $t$ 域平移求最终解：** 应用公式 (24) 得到 $y(t)$： $$y(t) = \frac{1}{5} \left( u_5(t)h(t - 5) - u_{10}(t)h(t - 10) \right) \quad \text{(24),}$$

**解的定性分析：**

- **$t < 5$：** $y=0$。
- **$t > 10$：** 强迫函数 $g(t)=1$。解是关于 $y=1/4$ 的简谐振荡（齐次解 $c_1 \cos(2t) + c_2 \sin(2t)$ 加上特解 $1/4$）。

**连续性洞察（新情况）：** 在本例中，强迫函数 $g(t)$ 是**连续的**。但是 $g'(t)$ 在 $t=5$ 和 $t=10$ 处是不连续的。因此，最高阶导数 $y''$ 连续，但 $y'''$ 具有不连续性，以匹配 $g'(t)$ 的不连续性。

------

**其他相关概念（周期函数）：**

本节前部的习题涉及周期函数（如锯齿波 和整流正弦波）。虽然计算公式没有在正文中给出，但这些例子暗示了拉普拉斯变换可以处理**周期性强迫函数**（这通常依赖于一个特定的公式，例如问题 24 的结果）。这进一步扩大了拉普拉斯方法的适用范围。



# 6.5 Impulse Functions

#### 1. 核心概念 (Core Concept)

本节的核心内容是定义和应用**单位脉冲函数 $\delta(t)$（狄拉克 $\delta$ 函数）**。

**直觉：** 在现实世界的应用中，我们经常遇到**脉冲现象**，即作用在系统上的电压或力具有**极大**的量值，但作用时间**极短**。例如，敲击一个物体或电路中的瞬时高压。传统函数无法准确描述这种在极短时间内提供固定“冲击强度”的现象，因此我们需要 $\delta$ 函数这个理想化的工具。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 脉冲强度 (Impulse) 的概念

对于一个微分方程 $ay'' + by' + cy = g(t)$，其中 $g(t)$ 是在时间 $t_0 - \tau < t < t_0 + \tau$ 期间作用的强迫函数，**脉冲强度 $I(\tau)$** 定义为 $g(t)$ 在该时间区间上的积分： $$ I(\tau) = \int_{t_0-\tau}^{t_0+\tau} g(t) dt = \int_{-\infty}^{\infty} g(t) dt \quad \text{(2), (3)} $$

- **物理意义：** 在机械系统中，$I(\tau)$ 是力 $g(t)$ 在该时间间隔内产生的**总冲量 (total impulse)**。在电路中，如果 $y$ 是电流，$g(t)$ 是电压的时间导数，则 $I(\tau)$ 代表施加在电路上的**总电压**。

##### 2.2 理想单位脉冲函数的推导

为了理想化脉冲，我们考虑一个具体的矩形脉冲函数 $d_{\tau}(t)$，该函数以 $t_0=0$ 为中心： $$ g(t) = d_{\tau}(t) = \begin{cases} \frac{1}{2\tau}, & -\tau < t < \tau \ 0, & t \le -\tau \text{ or } t \ge \tau \end{cases} \quad \text{(4)} $$

- **冲量恒定：** 无论 $\tau$ 是多少（只要 $\tau \ne 0$），计算 $d_{\tau}(t)$ 的总冲量 $I(\tau)$ 结果总是 **1**。 $$ I(\tau) = \int_{-\tau}^{\tau} \frac{1}{2\tau} dt = \frac{1}{2\tau} [t]_{-\tau}^{\tau} = \frac{1}{2\tau} (2\tau) = 1 $$

- **极限过程：** 现在，我们让 $\tau \to 0^+$，即让脉冲的作用时间越来越短，同时高度 $1/(2\tau)$ 越来越大，但保持冲量 $I(\tau)$ 恒定为 1。

- 狄拉克 $\delta$ 函数 $\delta(t)$：

   这个极限过程定义了一个理想化的

  单位脉冲函数

   $\delta$（通常称为

  狄拉克 $\delta$ 函数

  ，以 Paul A. M. Dirac 命名），它具有以下矛盾的性质：

  1. 除了 $t=0$ 之外，函数值为 0。 $$ \delta(t) = 0, \quad t \ne 0 \quad \text{(7)} $$
  2. 它在所有时间上的积分为 1（总冲量为 1）。 $$ \int_{-\infty}^{\infty} \delta(t) dt = 1 \quad \text{(8)} $$

- **广义函数 (Generalized Functions)：** $\delta$ 函数不是初等微积分中定义的**普通函数**，它是一个**广义函数 (generalized function)**，因为它同时满足了 (7) 和 (8) 这两个条件。

##### 2.3 平移的 $\delta$ 函数

单位脉冲发生在 $t=t_0$ 处的 $\delta$ 函数记为 $\delta(t-t_0)$： $$ \delta(t - t_0) = 0, \quad t \ne t_0 \quad \text{(9)} $$ $$ \int_{-\infty}^{\infty} \delta(t - t_0) dt = 1 \quad \text{(10)} $$

##### 2.4 $\delta$ 函数与连续函数的积分（笑脸函数/取样性质）

虽然 $\delta$ 函数的定义很奇怪，但它与任何连续函数 $f(t)$ 相乘后的积分具有非常简洁的性质： $$ \int_{-\infty}^{\infty} \delta(t - t_0) f(t) dt = f(t_0) \quad \text{(16)} $$ **直觉（取样性质/Sifting Property）：** $\delta(t-t_0)$ 在 $t=t_0$ 处瞬间“取样”了 $f(t)$ 的值 $f(t_0)$，并将其作为积分结果。这个结果是通过将 $f(t)$ 视为常数 $f(t^*)$（根据积分中值定理）然后取 $\tau \to 0^+$ 的极限得到的。

#### 3. 关键数学公式 (Formulas)

1. **平移的 $\delta$ 函数的拉普拉斯变换 (Laplace Transform of the Dirac Delta Function):** 对于 $t_0 > 0$ 的情况，通过极限定义得到： $$\mathcal{L}{\delta(t - t_0)} = e^{-st_0} \quad \text{(13)}$$
2. **单位脉冲 $\delta(t)$ 的拉普拉斯变换 (Laplace Transform at $t=0$):** 通过令 $t_0 \to 0^+$ 扩展公式 (13)，得到： $$\mathcal{L}{\delta(t)} = 1 \quad \text{(14)}$$

#### 4. 例题解析 (Example Walkthroughs)

##### 例 1：求解具有脉冲强迫函数的初值问题

**问题：** 求解初值问题 $2y'' + y' + 2y = \delta(t - 5)$，初值 $y(0) = 0, y'(0) = 0$。

- **背景：** 这与 6.4 节例 1 中研究的电路或机械振荡器是相同的，唯一的区别是强迫项现在是一个单位脉冲 $\delta(t-5)$，发生在 $t=5$。

**解题逻辑：**

1. 施加变换：

    对微分方程两边应用拉普拉斯变换 $\mathcal{L}$。

   - 左侧：由于初始条件 $y(0)=0, y'(0)=0$，变换结果为 $(2s^2 + s + 2) Y(s)$。
   - 右侧：应用公式 $\mathcal{L}{\delta(t-t_0)} = e^{-st_0}$ (此处 $t_0=5$)，结果为 $e^{-5s}$。 $$\left(2s^2 + s + 2\right) Y(s) = e^{-5s}$$

2. **求解 $Y(s)$：** $$Y(s) = e^{-5s} \frac{1}{2s^2 + s + 2} = e^{-5s} H(s)$$

3. 求 $H(s)$ 的逆变换 $h(t)$：

    对 $H(s)$ 进行代数处理（配方法）以应用 $s$ 域平移定理：

   - $2s^2 + s + 2 = 2 \left( (s + 1/4)^2 + 15/16 \right)$。
   - 将 $H(s)$ 写成已知形式： $$H(s) = \frac{1}{2} \frac{1}{(s + 1/4)^2 + 15/16} = \frac{1}{2} \frac{4/\sqrt{15}}{ (s + 1/4)^2 + (\sqrt{15}/4)^2 } \cdot \frac{\sqrt{15}}{4} \quad \text{(19)}$$
   - 根据 $s$ 域平移定理（定理 6.3.2）和正弦变换公式，得到 $h(t) = \mathcal{L}^{-1}{H(s)}$： $$h(t) = \frac{4}{\sqrt{15}} e^{-t/4} \sin\left(\frac{\sqrt{15}}{4} t\right) \quad \text{(20)}$$

4. 应用 $t$ 域平移求最终解：

    $Y(s)$ 具有 $e^{-cs} H(s)$ 的形式，应用逆 $t$ 域平移定理（定理 6.3.1），其中 $c=5$： $$y(t) = \mathcal{L}^{-1}{Y(s)} = u_5(t) h(t - 5) \quad \text{(21)}$$

   - 将 $h(t)$ 中的 $t$ 替换为 $(t-5)$，并将解写成分段形式。

**最终结果：** $$y(t) = \begin{cases} 0, & t < 5 \ \frac{2}{\sqrt{15}} e^{-(t-5)/4} \sin\left(\frac{\sqrt{15}}{4} (t - 5)\right), & t \ge 5 \end{cases} \quad \text{(22)}$$

**物理行为与连续性分析：**

- **$t < 5$：** 系统保持静止，因为初始条件为零，且在 $t=5$ 之前没有外部激励。
- **$t \ge 5$：** 脉冲在 $t=5$ 处产生了一个**瞬时冲击**，导致系统开始进行**衰减振荡**（由于 $e^{-(t-5)/4}$ 项）。
- **连续性：** 尽管强迫函数 $g(t) = \delta(t-5)$ 在 $t=5$ 处存在**奇点 (singularity)**，但解 $y(t)$ 在 $t=5$ 处却是**连续的**。
- **导数的跳跃：** 然而，解的**一阶导数 $y'(t)$ 在 $t=5$ 处存在跳跃不连续性**，而**二阶导数 $y''(t)$ 在 $t=5$ 处存在无限不连续性 (infinite discontinuity)**。这是微分方程 (17) 所要求的，因为方程一侧的奇点必须由另一侧的相应奇点来平衡。

**实用警告：** 在实际问题中，如果激励的持续时间很短，但**非零**，使用 $\delta$ 函数进行建模会引入误差。虽然这种误差通常可以忽略，但在实际工程应用中不应不加考虑地排除。

------

**学习启示 (Analogy):**

$\delta$ 函数就像一个**理想化的瞬时击打**。想象一个钟摆，你用一个**锤子**瞬间敲击它。

- 传统函数（如 6.4 节中的矩形脉冲）是给你一分钟的时间，用一个小的、恒定的推力推动钟摆。
- $\delta$ 函数是**在零时间**内，用**无限大的力量**给予钟摆一个固定的总冲量 (1)。 拉普拉斯变换的强大之处在于，它将这个理想化的“瞬时击打” $e^{-st_0}$ 干净利落地转换为 $s$ 域中的一个简单代数因子，使得我们能迅速求解 $Y(s)$，从而得到击打后系统立即开始响应的解 $y(t)$。





# 6.6 The Convolution Integral

#### 1. 核心概念 (Core Concept)

本节的核心主题是：**卷积积分 (Convolution Integral)** 及其**卷积定理 (Convolution Theorem)**。

**核心洞察：** 拉普拉斯变换**不能**与普通乘法进行交换。换句话说，如果 $H(s) = F(s)G(s)$，则 $h(t) \ne f(t)g(t)$。卷积定理引入了一种特殊的“广义乘积”——卷积，使得 $s$ 域中的乘法 $F(s)G(s)$ 对应于 $t$ 域中的卷积操作 $f * g$。

#### 2. 定义与直觉 (Definitions & Intuition)

##### 2.1 卷积定理 (Convolution Theorem)

**定义：** 两个函数 $f$ 和 $g$ 的**卷积 (convolution)** 记作 $h(t) = (f * g)(t)$，定义为以下积分： $$ h(t) = (f * g)(t) = \int_{0}^{t} f(t - \tau) g(\tau) d\tau = \int_{0}^{t} f(\tau) g(t - \tau) d\tau \quad \text{(2), (3)} $$ 这个积分被称为**卷积积分 (convolution integral)**。

**定理 6.6.1（卷积定理）：** 如果 $F(s) = \mathcal{L}{f(t)}$ 和 $G(s) = \mathcal{L}{g(t)}$ 都存在，那么它们的乘积 $H(s) = F(s)G(s)$ 的逆拉普拉斯变换是 $f$ 和 $g$ 的卷积 $h(t) = (f * g)(t)$。 $$ \mathcal{L}{ (f * g)(t) } = F(s) G(s) \quad \text{(1)} $$

**直觉（为什么需要卷积？）：**

1. **求逆变换：** 很多时候，一个复杂的 $s$ 域函数 $H(s)$ 可以很容易地分解成两个已知变换的乘积 $F(s)G(s)$。此时，虽然 $H(s)$ 可能很难通过分式分解来求逆变换，但根据卷积定理，我们可以通过计算 $f$ 和 $g$ 的卷积积分来求出 $h(t)$。
2. **系统历史依赖性 (Hereditary Systems)：** 卷积积分自然地出现在许多应用中，这些系统的行为在时间 $t$ 不仅取决于其在 $t$ 时刻的状态，还取决于其**过去的历史 (past history)**。这类系统有时被称为**遗传系统 (hereditary systems)**。

##### 2.2 卷积的性质

卷积 $f * g$ 具有许多与普通乘法相似的性质：

- 交换律 (Commutative Law):

   $f * g = g * f$。

  - **证明直觉：** 公式 (2) 中两个积分的等价性（通过变量替换 $t-\tau = \xi$）直接证明了卷积的交换性。

- **分配律 (Distributive Law):** $f * (g_1 + g_2) = f * g_1 + f * g_2$。

- **结合律 (Associative Law):** $(f * g) * h = f * (g * h)$。

- 零性质 (Zero Property):

   $f * 0 = 0 * f = 0$。

  - 这里的 0 指的是对于所有 $t$ 值都为 0 的函数。

**重要区别：** 并非所有普通乘法的性质都适用于卷积。例如，通常情况下 $f * 1$ **不等于** $f$。

##### 2.3 卷积与微分方程求解（输入-输出分析）

卷积定理在分析线性常系数微分方程的初值问题中起着基础性作用。

考虑一般的二阶初值问题: $$ ay'' + by' + cy = g(t), \quad y(0) = y_0, y'(0) = y'_0 \quad \text{(20), (21)} $$ 通过拉普拉斯变换，我们得到 $Y(s)$ 的解，可以分解为两部分： $$ Y(s) = \Phi(s) + \Psi(s) \quad \text{(23)} $$ 对应的时域解 $y(t)$ 也是两部分之和： $$ y(t) = \phi(t) + \psi(t) \quad \text{(24)} $$

**解的组成部分：**

1. **$\phi(t)$ (齐次解)：** $\phi(t)$ 是对应**齐次方程** $ay'' + by' + cy = 0$ 且满足给定**初值** $y(0)=y_0, y'(0)=y'_0$ 的解。这部分解只取决于系统的初始状态。
2. **$\psi(t)$ (特解)：** $\psi(t)$ 是满足**零初始条件** $y(0)=0, y'(0)=0$ 且受到**强迫函数 $g(t)$** 驱动的解。这部分解只取决于外部输入。

**关键概念 (Transfer Function & Impulse Response):** 为了找到 $\psi(t) = \mathcal{L}^{-1}{\Psi(s)}$，我们把 $\Psi(s)$ 写成强迫项 $G(s)$ 和一个系统特性的乘积： $$ \Psi(s) = H(s) G(s) \quad \text{(27)} $$

- **传递函数 $H(s)$ (Transfer Function):** $H(s)$ 定义为 $H(s) = (as^2 + bs + c)^{-1}$。它**仅取决于**系统本身的参数 $a, b, c$，而与输入 $g(t)$ 无关。
- **冲量响应 $h(t)$ (Impulse Response):** $h(t) = \mathcal{L}^{-1}{H(s)}$。当输入 $G(s)=1$ 时，对应于 $g(t) = \delta(t)$（单位冲量），此时 $\Psi(s) = H(s)$。因此，$h(t)$ 是系统在零初始条件下对**单位冲量** $\delta(t)$ 的响应。

**系统响应的卷积表示：** 根据卷积定理，解 $\psi(t)$ 可以表示为系统冲量响应 $h(t)$ 与强迫函数 $g(t)$ 的卷积： $$ \psi(t) = \mathcal{L}^{-1}{H(s) G(s)} = \int_{0}^{t} h(t - \tau) g(\tau) d\tau \quad \text{(28)} $$ 这表明：**系统对任意输入的响应 $\psi(t)$，是系统的冲量响应 $h(t)$ 与输入 $g(t)$ 的卷积**。

#### 3. 关键数学公式 (Formulas)

1. **卷积积分的定义 (Convolution Integral):** $$(f * g)(t) = \int_{0}^{t} f(t - \tau) g(\tau) d\tau = \int_{0}^{t} f(\tau) g(t - \tau) d\tau$$
2. **卷积定理 (Convolution Theorem):** $$\mathcal{L}^{-1}{F(s) G(s)} = (f * g)(t)$$
3. **一般二阶问题的解的卷积形式:** $$y(t) = \phi(t) + \psi(t)$$ 其中 $\phi(t) = \mathcal{L}^{-1}\left\{\frac{(as+b)y_0 + ay'*0}{as^2 + bs + c}\right\}$（齐次解，含初值）。 $$\psi(t) = \mathcal{L}^{-1}\left\{\frac{G(s)}{as^2 + bs + c}\right\} = \int*{0}^{t} h(t - \tau) g(\tau) d\tau \quad \text{(28)}$$ 且 $h(t) = \mathcal{L}^{-1}\left\{\frac{1}{as^2 + bs + c}\right\}$（冲量响应）。

#### 4. 例题解析 (Example Walkthroughs)

##### 例 1：利用卷积求逆变换 (Example 1)

**目标：** 求 $H(s) = \frac{a}{s^2(s^2 + a^2)}$ 的逆拉普拉斯变换 $h(t)$。

**解题逻辑：**

1. **分解 $H(s)$：** 将 $H(s)$ 分解为两个已知变换的乘积： $$H(s) = \left(\frac{1}{s^2}\right) \left(\frac{a}{s^2 + a^2}\right)$$
2. 识别 $f(t)$ 和 $g(t)$：
   - $F(s) = 1/s^2$ 对应 $f(t) = t$。
   - $G(s) = a/(s^2 + a^2)$ 对应 $g(t) = \sin(at)$。
3. **应用卷积定理：** $h(t) = (f * g)(t) = \int_{0}^{t} f(t-\tau) g(\tau) d\tau$。
4. **计算卷积积分：** 代入 $f(t-\tau) = t-\tau$ 和 $g(\tau) = \sin(a\tau)$。 $$h(t) = \int_{0}^{t} (t - \tau) \sin(a\tau) d\tau \quad \text{(9)}$$ （积分过程通过分部积分法完成，结果为 $\frac{at - \sin(at)}{a^2}$）。

**结果：** $h(t) = \frac{at - \sin(at)}{a^2}$。

##### 例 2：利用卷积表示微分方程的解 (Example 2)

**问题：** 求解初值问题 $y'' + 4y = g(t)$，初值 $y(0) = 3, y'(0) = -1$。

**解题逻辑：**

1. **施加变换：** 对微分方程施加变换并代入初始条件，解出 $Y(s)$。 $$s^2 Y(s) - 3s + 1 + 4 Y(s) = G(s)$$

2. **分解 $Y(s)$：** 将 $Y(s)$ 分解为 $\Phi(s)$（齐次项）和 $\Psi(s)$（强迫项）： $$Y(s) = \underbrace{\frac{3s - 1}{s^2 + 4}}*{\Phi(s)} + \underbrace{\frac{G(s)}{s^2 + 4}}*{\Psi(s)} \quad \text{(17)}$$

3. 计算 $\phi(t)$：

    对 $\Phi(s)$ 求逆变换。

   - $\frac{3s}{s^2+4}$ 对应 $3\cos(2t)$。
   - $\frac{1}{s^2+4} = \frac{1}{2}\frac{2}{s^2+4}$ 对应 $\frac{1}{2}\sin(2t)$。
   - $\phi(t) = 3\cos(2t) - \frac{1}{2}\sin(2t)$。

4. 计算 $\psi(t)$ (应用卷积)：

    $\Psi(s) = G(s) H(s)$，其中 $H(s) = \frac{1}{s^2+4}$ 是传递函数。

   - 求冲量响应 $h(t) = \mathcal{L}^{-1}{H(s)} = \mathcal{L}^{-1}{\frac{1}{s^2+4}} = \frac{1}{2}\sin(2t)$。
   - 应用卷积定理 $\psi(t) = (h * g)(t) = \int_{0}^{t} h(t-\tau) g(\tau) d\tau$。 $$\psi(t) = \frac{1}{2} \int_{0}^{t} \sin(2(t - \tau)) g(\tau) d\tau \quad \text{(19)}$$

5. **组合解：** $y(t) = \phi(t) + \psi(t)$。

**最终结果：** $$y(t) = 3\cos(2t) - \frac{1}{2}\sin(2t) + \frac{1}{2} \int_{0}^{t} \sin(2(t - \tau)) g(\tau) d\tau \quad \text{(19)}$$

**总结洞察：** 这个例子展示了卷积定理的强大之处：即使不知道具体的强迫函数 $g(t)$，我们也能用一个简洁的积分形式**全面表达**出系统的输出 $y(t)$，其中积分部分包含了 $g(t)$ 的所有影响。



